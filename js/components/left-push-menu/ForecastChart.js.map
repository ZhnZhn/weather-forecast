{"version":3,"sources":["../../../src/components/left-push-menu/ForecastChart.jsx"],"names":["Component","React","CartesianGrid","Chart","Bar","Line","YAxis","XAxis","ResponsiveContainer","Tooltip","Legend","ComposedChart","_data","day","tempDay","tempNight","_fnAdapter","arr","data","map","item","index","timestamp","dt","rain","speed","temp","night","morn","eve","max","min","toShortDayOfWeek","tempMorn","tempEve","tempMax","tempMin","fnFilter","filters","length","keys","Object","_item","assign","forEach","dataKey","ForecastChart","state","_onStore","store","props","getState","recent","sForecast","setState","prev","listById","handleFilter","_filters","componentDidMount","unsubsribe","subscribe","componentWillUnmount","shouldComponentUpdate","nextProps","nextState","render","STYLE","value","YAxisRain","YAxisSpeed","LABEL","fnLegendLabel","LineSpeed","LineTempMin","LineTempMax","LineTempEve","LineTempMorn","LineTempNight","LineTempDay"],"mappings":"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","sourcesContent":["//import React , { Component } from 'react';\r\nimport React from '../_react'\r\n//import PropTypes from 'prop-types';\r\n\r\nimport Chart from '../charts/Chart'\r\n\r\nimport dt from '../../utils/dt';\r\nimport { sForecast } from '../../flux/selectors';\r\n\r\nimport TooltipTemperature from './TooltipTemperature';\r\nimport LegendTemperature from './LegendTemperature';\r\n\r\nimport STYLE from './Chart.Style';\r\nimport LABEL from './Label.Style';\r\n\r\nconst { Component } = React;\r\nconst {\r\n  CartesianGrid,\r\n  Bar,\r\n  Line,\r\n  YAxis,\r\n  XAxis,\r\n  ResponsiveContainer,\r\n  Tooltip,\r\n  Legend,\r\n  ComposedChart\r\n} = Chart\r\n\r\nconst _data = [\r\n      {day: 'Page A', tempDay: 40, tempNight: 30},\r\n      {day: 'Page B', tempDay: 30, tempNight: 30},\r\n      {day: 'Page C', tempDay: 20, tempNight: 30},\r\n      {day: 'Page D', tempDay: 27, tempNight: 30},\r\n      {day: 'Page E', tempDay: 18, tempNight: 30},\r\n      {day: 'Page F', tempDay: 23, tempNight: 30},\r\n      {day: 'Page G', tempDay: 34, tempNight: 30}\r\n];\r\n\r\nconst _fnAdapter = (arr=[]) => {\r\n  const data = arr.map((item, index) => {\r\n    const { dt:timestamp, rain=0, speed, temp={} } = item\r\n        , {\r\n            day=null, night=null, morn=null,\r\n            eve=null, max=null, min=null\r\n          } = temp;\r\n     return {\r\n        day: dt.toShortDayOfWeek(timestamp),\r\n        tempDay: day,\r\n        tempNight: night,\r\n        tempMorn: morn,\r\n        tempEve: eve,\r\n        tempMax: max,\r\n        tempMin: min,\r\n        rain: rain,\r\n        speed: speed\r\n     };\r\n  });\r\n  return data;\r\n}\r\n\r\nconst fnFilter = (data=[], filters={}) => {\r\n  if (filters.length === 0){\r\n    return data;\r\n  }\r\n  const keys = Object.keys(filters);\r\n  return data.map((item) => {\r\n     const _item = Object.assign({}, item)\r\n     keys.forEach((dataKey) => {\r\n        if (!filters[dataKey]) {\r\n          _item[dataKey] = null;\r\n        }\r\n     })\r\n     return _item;\r\n  });\r\n}\r\n\r\nclass ForecastChart extends Component {\r\n  /*\r\n  static propTypes = {\r\n    store : PropTypes.object.isRequired\r\n  }\r\n  */\r\n\r\n  state = {\r\n    data : _data,\r\n    filters : {\r\n      tempDay : true,\r\n      tempNight : true,\r\n      tempMorn : false,\r\n      tempEve : false,\r\n      tempMax : false,\r\n      tempMin : false,\r\n      rain : true,\r\n      speed : true\r\n    }\r\n  }\r\n\r\n  componentDidMount(){\r\n    const { store } = this.props\r\n    this.unsubsribe = store.subscribe(this._onStore);\r\n  }\r\n  _onStore = () => {\r\n    const { store } = this.props\r\n    , state = store.getState()\r\n    , recent = sForecast.recent(state);\r\n    if (recent && this.recent !== recent ){\r\n      this.recent = recent;\r\n      this.setState((prev) => ({\r\n        data : _fnAdapter(sForecast.listById(state, recent))\r\n      }))\r\n    }\r\n  }\r\n  componentWillUnmount(){\r\n    this.unsubsribe();\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState){\r\n    if (this.props !== nextProps){\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  handleFilter = (dataKey) => {\r\n     const { filters } = this.state\r\n     let _filters = Object.assign({}, filters);\r\n     if (!filters[dataKey]){\r\n       _filters[dataKey] = true\r\n     } else {\r\n       _filters[dataKey] = false\r\n     }\r\n     this.setState({ filters: _filters })\r\n  }\r\n\r\n  render(){\r\n    const { data, filters } = this.state\r\n    , _data = fnFilter(data, filters)\r\n\r\n    return (\r\n      <ResponsiveContainer width=\"100%\" height={300} >\r\n\r\n      <ComposedChart data={_data} {...STYLE.ComposedChart}>\r\n        <XAxis dataKey=\"day\" {...STYLE.XAxis} />\r\n        <YAxis label={{\r\n           value: \"°C\",\r\n           //offset: -18,\r\n           //position: 'insideTop'\r\n           //angle: -90,\r\n           //position: 'insideLeft'\r\n           //offset: 10,\r\n           //position: \"insideTopRight\",\r\n           //position: \"insideStart\"\r\n         }}/>\r\n        <YAxis\r\n           yAxisId={1} dataKey=\"rain\" orientation=\"right\" label=\"mm\"\r\n           {...STYLE.YAxisRain}\r\n        />\r\n        <YAxis\r\n           hide={!filters.speed}\r\n           yAxisId={2} dataKey=\"speed\" orientation=\"right\" label=\"m/s\"\r\n           {...STYLE.YAxisSpeed}\r\n        />\r\n\r\n        <CartesianGrid {...STYLE.CartesianGrid} />\r\n\r\n        <Tooltip\r\n          offset={24}\r\n          content={<TooltipTemperature data={data} />}\r\n        />\r\n\r\n        <Legend\r\n          content={\r\n             <LegendTemperature\r\n                 styles={LABEL.fnLegendLabel(filters)}\r\n                 onFilter={this.handleFilter}\r\n              />\r\n          }\r\n        />\r\n        <Bar\r\n           dataKey=\"rain\"\r\n           yAxisId={1} barSize={20} fill=\"#0922a5\"\r\n        />\r\n\r\n        <Line dataKey=\"speed\" yAxisId={2} {...STYLE.LineSpeed} />\r\n\r\n        <Line dataKey=\"tempMin\" {...STYLE.LineTempMin} />\r\n        <Line dataKey=\"tempMax\" {...STYLE.LineTempMax} />\r\n\r\n        <Line dataKey=\"tempEve\" {...STYLE.LineTempEve} />\r\n        <Line dataKey=\"tempMorn\" {...STYLE.LineTempMorn} />\r\n        <Line dataKey=\"tempNight\" {...STYLE.LineTempNight} />\r\n        <Line dataKey=\"tempDay\" {...STYLE.LineTempDay} />\r\n\r\n      </ComposedChart>\r\n\r\n      </ResponsiveContainer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ForecastChart\r\n"],"file":"ForecastChart.js"}